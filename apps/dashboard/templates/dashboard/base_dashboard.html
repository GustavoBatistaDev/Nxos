{% load static %}
  <!DOCTYPE html>
  <html lang="pt-br">
  
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Menu Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>

    <link rel="stylesheet" href="{% static 'messages.css'%}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link rel="stylesheet" href="{% static 'dashboard/css/dashboard.css'%}">
    <link rel="stylesheet" href="{% static 'dashboard/css/project.css'%}">
    <link href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet'>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://kit.fontawesome.com/d39a76ffb3.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
  </head>
  
  <body>
    <nav>
      <div class="sidebar-top">
        <span class="shrink-btn">
          <i class='bx bx-chevron-left'></i>
        </span>
        {% if request.user.photo %}
            <img id="picture_user" height="50" width="40" src="{{request.user.photo.url}}" class=" logo " alt="">
        {% else %}
            <img id="picture_user" src="{% static 'dashboard/img/user.webp'%}" class="logo " alt=""> 
        {% endif %}
        <h3 class="hide">{{request.user.first_name}}</h3>
      </div>
  
    <form action="{% url 'dashboard:projects' %}" method="GET">
      <div class="search">
        <i class='bx bx-search'></i>
        <input value="{{request.GET.search}}" name="search" type="text" class="hide" placeholder="Quick Search ...">
      </div>
    </form>
  
      <div class="sidebar-links">
        <ul>
          <div class=""></div>
          <li class="tooltip-element" data-tooltip="0">
            <a href="{% url 'dashboard:dashboard'%}" class="active" data-active="0">
              <div class="icon">
                <i class='bx bx-tachometer'></i>
                <i class='bx bxs-tachometer'></i>
              </div>
              <span class="link hide">Dashboard</span>
            </a>
          </li>
          <li class="tooltip-element" data-tooltip="1">
            <a href="{% url 'dashboard:profile'%}" data-active="1">
              <div class="icon">
                <i class='bx bx-folder'></i>
                <i class='bx bxs-folder'></i>
              </div>
              <span class="link hide">Profile</span>
            </a>
          </li>
          <li class="tooltip-element" data-tooltip="2">
            <a href="{% url 'dashboard:projects'%}" data-active="2">
              <div class="icon">
                <i class='bx bx-message-square-detail'></i>
                <i class='bx bxs-message-square-detail'></i>
              </div>
              <span class="link hide">Projects</span>
            </a>
          </li>
          <li class="tooltip-element" data-tooltip="3">
            <a href="#" data-active="3">
              <div class="icon">
                <i class='bx bx-bar-chart-square'></i>
                <i class='bx bxs-bar-chart-square'></i>
              </div>
              <span class="link hide">Settings</span>
            </a>
          </li>
          <div class="tooltip">
            <span class="show">Dashboard</span>
            <span>Projects</span>
            <span>Messages</span>
            <span>Settings</span>
          </div>
        </ul>
  
       
      </div>
  
      <div class="sidebar-footer">
        <a href="#" class="account tooltip-element" data-tooltip="0">
          <i class='bx bx-user'></i>
        </a>
        
        <div class="admin-user tooltip-element" data-tooltip="1">
          <div class="admin-profile hide">
            <img src="logo.png" alt="">
            <div class="admin-info">
              <h3>ADMIN</h3>
            </div>
          </div>
          <a href="{% url 'authentication:logout'%}" class="log-out">
            <i class='bx bx-log-out'></i>
          </a>
        </div>
  
        <div class="tooltip">
          <span class="show">{{request.user.username}}</span>
          <span>Logout</span>
        </div>
      </div>
    </nav>
    
    <main >
        {% if messages%}
            {% for i in messages%}

            <div id="text" class="text w-75 ">
              
                <p class="text-warning mb-3">{{i}}</p>
            </div>
            
            {% endfor %}
        {% endif %}
        {% block 'main'%}

        {% endblock %}

    </main>

  
   


              

   

   
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>
  <script src="{% static 'dashboard/js/chat.js'%}"></script>
  <script src="{% static 'dashboard/js/dashboard.js'%}"></script>
  <script src="{% static 'dashboard/js/project.js'%}"></script>
  <script src="{% static 'dashboard/js/profile.js'%}"></script>

 
  <script>
    // Chave de API do OpenAI
  const apiKey = "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"
  $("#messageArea").on("submit", function(e){
      e.preventDefault();
  
      const date = new Date();
            const hour = date.getHours();
            const minute = date.getMinutes();
            const str_time = hour+":"+minute;
            var rawText = $("#message-input").val();
                      var rawTextInput = $("#message-input")
            
            $("#message-input").val("");
      
                      var userHtml = '<div class="d-flex justify-content-end mb-4"><div class="msg_cotainer_send">' + rawText + '<span class="msg_time_send">'+ str_time + 
                      '</span></div><div class="img_cont_msg"><img id="picture_user" src="{% if request.user.photo %}{{request.user.photo.url}} {% else%} https://static.vecteezy.com/system/resources/previews/000/439/863/original/vector-users-icon.jpg{% endif %}" class="rounded-circle user_img_msg"></div></div>';
                      
                      $("#messageFormeight").append(userHtml);
            
                      fetch("https://api.openai.com/v1/completions",{
                          method: 'POST',
                          headers: {
                              Accept: "application/json",
                              "Content-Type": "application/json",
                              Authorization: `Bearer ${apiKey}`,
                          },
                          body: JSON.stringify({
                              model: "text-davinci-003",
                              prompt: rawText,
                              max_tokens: 2048, // tamanho da resposta
                              temperature: 0.5 // criatividade na resposta
                          })
                      })
                      .then((response) => response.json())
                      .then((response) => {
                         
                          var botHtml = '<div id="" class="d-flex justify-content-start mb-4"> <div class="img_cont_msg"><img src="https://i.ibb.co/fSNP7Rz/icons8-chatgpt-512.png" class="rounded-circle user_img_msg"></div><div class="msg_cotainer"><i class="fa-solid fa-copy fa-1x"></i>' + response.choices[0]['text']   + '</div></div>';
              $("#messageFormeight").append($.parseHTML(botHtml));
  
                          $(document).ready(function() {
                              // Adicionar um ID dinâmico a cada div
                              $(".my-div").each(function(index) {
                                $(this).attr("id", "div-" + (index + 1));
                              });
                              
                              // Adicionar um manipulador de evento de clique em cada ícone de cópia
                              $(".fa-copy").click(function() {
                                // Obter o conteúdo da div correspondente
                                var content = $(this).parent().text().trim();
                                
                                // Copiar o conteúdo para a área de transferência
                                navigator.clipboard.writeText(content);
                                
                                // Exibir uma mensagem informando que o conteúdo foi copiado
                                alert('Texto copiado com sucesso!');
                               
                              });
                            });
                        
                      })
                      .catch((e) => {
                          console.log(`Error -> ${e}`)
                          
                      })
                      .finally(() => {
                         
                          rawTextInput.disabled = false
                          rawTextInput.value = ''
                      })
                     
            });		
  </script>     
    
 

  

  </body>
  
  </html>



